ЁЯФБ 1я╕ПтГг min_healthy_percentage
Context: рд╣реЗ Terraform (рдХрд┐рдВрд╡рд╛ AWS ASG) update policy рдордзреНрдпреЗ рд╡рд╛рдкрд░рд▓реЗ рдЬрд╛рддреЗ.
ЁЯСЙ Meaning:
Rolling update рджрд░рдореНрдпрд╛рди тАФ ASG рдордзреАрд▓ рдХрд┐рдорд╛рди рдХрд┐рддреА рдЯрдХреНрдХреЗ instances healthy (in service) рд░рд╛рд╣рд╛рдпрд▓рд╛ рд╣рд╡реЗрдд, рддреЗ рд╕рд╛рдВрдЧрддреЗ.
ЁЯТб Example:
update_policy {
  min_healthy_percentage = 70
}

Meaning:
рдЬрд░ рддреБрдЭреНрдпрд╛рдХрдбреЗ 10 instances рдЖрд╣реЗрдд, рдЖрдгрд┐ рддреВ min_healthy_percentage = 70 рджрд┐рд▓рдВ,
рддрд░ Terraform рдХрд┐рдВрд╡рд╛ ASG рдиреЗ рдПрдХрд╛рд╡реЗрд│реА рдЬрд╛рд╕реНрддреАрдд рдЬрд╛рд╕реНрдд 3 instances terminate рдХрд░реВрди replace рдХрд░рдгрд╛рд░ (рдХрд╛рд░рдг 70% рдореНрд╣рдгрдЬреЗ 7 instances рдиреЗрд╣рдореА healthy рд░рд╛рд╣рддреАрд▓).
Real-time usage:
Production environment рд╕рд╛рдареА 70тАУ80% safe value рдЕрд╕рддреЗ (рдХрдзреА 100% рдкрдг рдареЗрд╡рддрд╛рдд zero downtime рд╕рд╛рдареА).
Development рд╕рд╛рдареА 50% рдЪрд╛рд▓рддреЗ рдХрд╛рд░рдг downtime рдереЛрдбрдВ рдЪрд╛рд▓рддрдВ.

тЪЩя╕П 2я╕ПтГг upper_threshold
Context: рд╣реЗ CloudWatch Alarm рдордзреНрдпреЗ рд╡рд╛рдкрд░рддрд╛рдд тАФ Auto Scaling Group рд▓рд╛ scale out рдХрдзреА рдХрд░рд╛рдпрдЪрдВ рд╣реЗ рд╕рд╛рдВрдЧрдгреНрдпрд╛рд╕рд╛рдареА.
ЁЯСЙ Meaning:
рдЬреЗрд╡реНрд╣рд╛ CPU utilization рдпрд╛ рдЯрдХреНрдХреНрдпрд╛рдВрдкреЗрдХреНрд╖рд╛ рдЬрд╛рд╕реНрдд рдЬрд╛рддреЗ, рддреЗрд╡реНрд╣рд╛ ASG рдирд╡реАрди EC2 instances рд╡рд╛рдврд╡рддреЗ.
ЁЯТб Example:
upper_threshold = 70

Meaning:
рдЬрд░ average CPU usage > 70% рдЭрд╛рд▓рд╛, рддрд░ CloudWatch alarm trigger рд╣реЛрдИрд▓
тЖТ Auto Scaling Policy тАЬscale outтАЭ рдЪрд╛рд▓рд╡реЗрд▓
тЖТ рдирд╡реАрди instances add рд╣реЛрддреАрд▓.
Real-time usage:
Typical values:


upper_threshold = 70 (for production)


upper_threshold = 80 (for dev/test)



тЪЩя╕П 3я╕ПтГг lower_threshold
Context: рд╣реЗ рд╕реБрджреНрдзрд╛ CloudWatch Alarm рд╕рд╛рдареА рдЖрд╣реЗ тАФ Auto Scaling Group рд▓рд╛ scale in рдХрдзреА рдХрд░рд╛рдпрдЪрдВ рд╣реЗ рд╕рд╛рдВрдЧрдгреНрдпрд╛рд╕рд╛рдареА.
ЁЯСЙ Meaning:
рдЬреЗрд╡реНрд╣рд╛ CPU utilization рдпрд╛ рдЯрдХреНрдХреНрдпрд╛рдВрдкреЗрдХреНрд╖рд╛ рдХрдореА рдЬрд╛рддреЗ, рддреЗрд╡реНрд╣рд╛ ASG instances рдХрдореА рдХрд░рддреЗ (terminate рдХрд░рддреЗ).
ЁЯТб Example:
lower_threshold = 20

Meaning:
рдЬрд░ CPU usage < 20% рдЭрд╛рд▓рд╛ рдХрд╛рд╣реА рд╡реЗрд│реЗрд╕рд╛рдареА (рдЙрджрд╛. 5 mins), рддрд░ CloudWatch alarm trigger рд╣реЛрдИрд▓
тЖТ Auto Scaling Policy тАЬscale inтАЭ рдЪрд╛рд▓рд╡реЗрд▓
тЖТ рдХрд╛рд╣реА instances terminate рд╣реЛрддреАрд▓ (рдЬреНрдпрд╛рдиреЗ рдЦрд░реНрдЪ рдХрдореА рд╣реЛрдИрд▓).
Real-time usage:
Typical values:


lower_threshold = 20 (for prod)


lower_threshold = 30 (for dev/test)



ЁЯза Final Summary Table
ParameterPurposeReal-time Example (Prod)min_healthy_percentageRolling update рджрд░рдореНрдпрд╛рди minimum healthy EC2 instances80upper_thresholdCPU usage тЖС рдЭрд╛рд▓реНрдпрд╛рд╡рд░ scale-out trigger70lower_thresholdCPU usage тЖУ рдЭрд╛рд▓реНрдпрд╛рд╡рд░ scale-in trigger20

тЬЕ Typical Real-time Values (Gradual Rolling Update Strategy):
-var 'min_healthy_percentage=80' \
-var 'upper_threshold=70' \
-var 'lower_threshold=20'


рд╣рд╡рдВ рдХрд╛ рдореА рддреБрд▓рд╛ рджрд╛рдЦрд╡реВ рдХрд╕рд╛ рд╣рд╛ auto scaling + CloudWatch alarm Terraform рдХреЛрдбрдордзреНрдпреЗ рджрд┐рд╕рддреЛ (with these variables)?
рддреЗ рдХреЗрд▓реНрдпрд╛рд╕ рддреБрд▓рд╛ visualize рд╣реЛрдИрд▓ рдХреА рд╣реЗ thresholds рдЖрдгрд┐ percentage рдХрд╕реЗ рд▓рд╛рдЧреВ рд╣реЛрддрд╛рдд.
